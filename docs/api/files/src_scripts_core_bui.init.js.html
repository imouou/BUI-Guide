<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>src/scripts/core/bui.init.js - BUI</title>
    <!-- <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css"> -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="../assets/css/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/js/jquery-1.9.1.min.js"></script>
</head>

<body class="yui3-skin-sam">
    <div id="sidemenu" class="sidebar-menu">菜单</div>
    <div id="doc">
        <div id="hd" class="yui3-g header" style="display: none;">
            <div class="yui3-u-3-4">
                <h1><a href="../index.html"><img src="../assets/css/logo.png"
                            title="BUI" width="30px"></a>
                    <a href="../index.html">BUI</a>
                </h1>
                <p class="off-left">其它版本:<select name="" id="" onchange="window.open(this.value)">
                        <option value="../api/index.html" selected>1.8.x</option>
                        <option value="../api-1.7.x/index.html">1.7.x</option>
                        <option value="../api-1.6.x/index.html">1.6.x</option>
                        <option value="../api-1.5.x/index.html">1.5.x</option>
                        <option value="../api-1.4.8/index.html">1.4.x</option>
                    </select></p>
                <p class="off-left" style="font-size:12px;margin-right: 15px;">API for BUI
                    1.8.x </p>

            </div>
        </div>
        <div id="bd" class="yui3-g" style="padding-top: 0;">
            <div id="sidebar" class="yui3-u-1-4" style="top:0;">

                <a href="../index.html"
                    style="display: block;padding:6px;font-size:16px;background:#fff;position:absolute;z-index:1000;width:70px;letter-spacing:2px;text-align:right;left:220px;top:20px;color:#333;">返回</a>

                <div id="docs-sidebar" class="sidebar apidocs">
                    <div id="api-list">
                        <div id="api-tabview" class="tabview">
                    
                            <ul class="tabs">
                                <li><a href="#api-classes">Classes</a></li>
                                <li><a href="#api-modules">Modules</a></li>
                            </ul>
                    
                            <div id="api-tabview-filter">
                                <input type="search" id="api-filter" placeholder="Type to filter APIs">
                            </div>
                    
                            <div id="api-tabview-panel">
                                <ul id="api-classes" class="apis classes">
                                    <li><a href="../classes/bui.accordion.html">bui.accordion</a></li>
                                    <li><a href="../classes/bui.actionsheet.html">bui.actionsheet</a></li>
                                    <li><a href="../classes/bui.ajax.html">bui.ajax</a></li>
                                    <li><a href="../classes/bui.alert.html">bui.alert</a></li>
                                    <li><a href="../classes/bui.all.html">bui.all</a></li>
                                    <li><a href="../classes/bui.animate.html">bui.animate</a></li>
                                    <li><a href="../classes/bui.array.html">bui.array</a></li>
                                    <li><a href="../classes/bui.back.html">bui.back</a></li>
                                    <li><a href="../classes/bui.btn.html">bui.btn</a></li>
                                    <li><a href="../classes/bui.checkVersion.html">bui.checkVersion</a></li>
                                    <li><a href="../classes/bui.cmd.html">bui.cmd</a></li>
                                    <li><a href="../classes/bui.config.html">bui.config</a></li>
                                    <li><a href="../classes/bui.confirm.html">bui.confirm</a></li>
                                    <li><a href="../classes/bui.date.html">bui.date</a></li>
                                    <li><a href="../classes/bui.delete.html">bui.delete</a></li>
                                    <li><a href="../classes/bui.dialog.html">bui.dialog</a></li>
                                    <li><a href="../classes/bui.download.html">bui.download</a></li>
                                    <li><a href="../classes/bui.dropdown.html">bui.dropdown</a></li>
                                    <li><a href="../classes/bui.emitter.html">bui.emitter</a></li>
                                    <li><a href="../classes/bui.extend.html">bui.extend</a></li>
                                    <li><a href="../classes/bui.file.html">bui.file</a></li>
                                    <li><a href="../classes/bui.fileselect.html">bui.fileselect</a></li>
                                    <li><a href="../classes/bui.floor.html">bui.floor</a></li>
                                    <li><a href="../classes/bui.get.html">bui.get</a></li>
                                    <li><a href="../classes/bui.getPageParams.html">bui.getPageParams</a></li>
                                    <li><a href="../classes/bui.guid.html">bui.guid</a></li>
                                    <li><a href="../classes/bui.hint.html">bui.hint</a></li>
                                    <li><a href="../classes/bui.history.html">bui.history</a></li>
                                    <li><a href="../classes/bui.init.html">bui.init</a></li>
                                    <li><a href="../classes/bui.input.html">bui.input</a></li>
                                    <li><a href="../classes/bui.levelselect.html">bui.levelselect</a></li>
                                    <li><a href="../classes/bui.list.html">bui.list</a></li>
                                    <li><a href="../classes/bui.listview.html">bui.listview</a></li>
                                    <li><a href="../classes/bui.load.html">bui.load</a></li>
                                    <li><a href="../classes/bui.loader.html">bui.loader</a></li>
                                    <li><a href="../classes/bui.loading.html">bui.loading</a></li>
                                    <li><a href="../classes/bui.mask.html">bui.mask</a></li>
                                    <li><a href="../classes/bui.number.html">bui.number</a></li>
                                    <li><a href="../classes/bui.page.html">bui.page</a></li>
                                    <li><a href="../classes/bui.pickerdate.html">bui.pickerdate</a></li>
                                    <li><a href="../classes/bui.platform.html">bui.platform</a></li>
                                    <li><a href="../classes/bui.popover.html">bui.popover</a></li>
                                    <li><a href="../classes/bui.post.html">bui.post</a></li>
                                    <li><a href="../classes/bui.prompt.html">bui.prompt</a></li>
                                    <li><a href="../classes/bui.pullrefresh.html">bui.pullrefresh</a></li>
                                    <li><a href="../classes/bui.put.html">bui.put</a></li>
                                    <li><a href="../classes/bui.rating.html">bui.rating</a></li>
                                    <li><a href="../classes/bui.ready.html">bui.ready</a></li>
                                    <li><a href="../classes/bui.refresh.html">bui.refresh</a></li>
                                    <li><a href="../classes/bui.router.html">bui.router</a></li>
                                    <li><a href="../classes/bui.run.html">bui.run</a></li>
                                    <li><a href="../classes/bui.scroll.html">bui.scroll</a></li>
                                    <li><a href="../classes/bui.searchbar.html">bui.searchbar</a></li>
                                    <li><a href="../classes/bui.select.html">bui.select</a></li>
                                    <li><a href="../classes/bui.setting.html">bui.setting</a></li>
                                    <li><a href="../classes/bui.sidebar.html">bui.sidebar</a></li>
                                    <li><a href="../classes/bui.slide.html">bui.slide</a></li>
                                    <li><a href="../classes/bui.stepbar.html">bui.stepbar</a></li>
                                    <li><a href="../classes/bui.storage.html">bui.storage</a></li>
                                    <li><a href="../classes/bui.store.html">bui.store</a></li>
                                    <li><a href="../classes/bui.swipe.html">bui.swipe</a></li>
                                    <li><a href="../classes/bui.tab.html">bui.tab</a></li>
                                    <li><a href="../classes/bui.timer.html">bui.timer</a></li>
                                    <li><a href="../classes/bui.toggle.html">bui.toggle</a></li>
                                    <li><a href="../classes/bui.touch.html">bui.touch</a></li>
                                    <li><a href="../classes/bui.typeof.html">bui.typeof</a></li>
                                    <li><a href="../classes/bui.unit.html">bui.unit</a></li>
                                    <li><a href="../classes/bui.upload.html">bui.upload</a></li>
                                    <li><a href="../classes/bui.viewport.html">bui.viewport</a></li>
                                </ul>
                    
                                <ul id="api-modules" class="apis modules">
                                    <li><a href="../modules/Animate.html">Animate</a></li>
                                    <li><a href="../modules/Core.html">Core</a></li>
                                    <li><a href="../modules/Event.html">Event</a></li>
                                    <li><a href="../modules/Method.html">Method</a></li>
                                    <li><a href="../modules/Native.html">Native</a></li>
                                    <li><a href="../modules/UI.html">UI</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        // iframe 里执行脚本，通过引入index.js 的方式无法成功
                        function sidebarInit() {
                            var sidebarHeight = $(window).height() - 153;
                    
                            $("#api-tabview-panel").height(sidebarHeight);
                        }
                        sidebarInit();
                    </script>                </div>
            </div>
            <div class="yui3-u-3-4">
                    <div id="api-options">
                        Show:
                        <label for="api-show-inherited">
                            <input type="checkbox" id="api-show-inherited" checked>
                            Inherited
                        </label>
                
                        <label for="api-show-protected">
                            <input type="checkbox" id="api-show-protected">
                            Protected
                        </label>
                
                        <label for="api-show-private">
                            <input type="checkbox" id="api-show-private">
                            Private
                        </label>
                        <label for="api-show-deprecated">
                            <input type="checkbox" id="api-show-deprecated">
                            Deprecated
                        </label>
                
                    </div>
                
                <div class="apidocs">
                    <div id="docs-main">
                        <div class="content">
                            <h1 class="file-heading">File: src/scripts/core/bui.init.js</h1>
                            
                            <div class="file">
                                <pre class="code prettyprint linenums">
                            /**
                             * 核心
                             * @module Core
                             */
                            
                            ;
                            (function (ui, $) {
                            
                                /**
                                 * init 页面初始化,动态计算main高度 默认已经执行,可以通过bui.config.init.auto = false; 修改为不执行.
                                 * @namespace  bui
                                 * @class  init
                                 * @since 1.3.4
                                 * @param {object|number} [option]
                                 * @param {string} [option.id] 初始化的页面ID, 默认: &quot;.bui-page&quot;
                                 * @param {number} [option.height] 初始化一个固定高度,会自动减去header,footer得到main的值
                                 * @param {string} [option.header] 默认: header 标签, 可以是 &quot;#id&quot;或者&quot;.classname&quot;
                                 * @param {string} [option.main] 默认: main 标签, 可以是 &quot;#id&quot;或者&quot;.classname&quot;
                                 * @param {string} [option.footer] 默认: footer 标签, 可以是 &quot;#id&quot;或者&quot;.classname&quot;
                                 * @param {number} [option.reduceRem] 1.5.3新增, 默认: 0, 这个值会自动根据屏幕分辨率自动改变, 跟切图规范保持一致 px/100 
                                 * @return {number} [返回main的高度]
                                 *
                                 * @constructor
                                 * @example
                                 *
                                 * 方法一: 根据页面高度初始化高度
                                 *
                                     bui.init();
                            
                                 * 方法二: 传固定高度计算main的高度
                                 *
                                     bui.init(500);
                            
                                 * 方法三: 每个页面都有独立的id
                                 *
                                     bui.init({
                                        id: &quot;#page&quot;
                                     })
                                 *
                                 * 方法四: 选择器不再是 header,main,footer 时可以通过对象修改
                                 *
                                     bui.init({
                                        header: &quot;#header&quot;,
                                        main: &quot;#main&quot;,
                                        footer: &quot;#footer&quot;
                                     })
                                 *
                                 */
                            
                            
                                ui.init = function (option) {
                                    var config = {
                                        id: &quot;.bui-page&quot;,
                                        height: 0,
                                        header: &quot;header&quot;,
                                        main: &quot;main&quot;,
                                        footer: &quot;footer&quot;,
                                        reduceRem: 0,
                                    }
                                    var options;
                                    if (ui.typeof(option) == &quot;object&quot;) {
                                        options = $.extend({}, config, ui.config.init, option);
                                    } else {
                                        var opt = {};
                                        opt.height = option;
                                        options = $.extend({}, config, opt);
                                    }
                                    var obj = function (name) {
                                        return (document.querySelectorAll(name) || document.getElementsByTagName(name)[0] || document.getElementById(name));
                                    }
                            
                                    // 安卓9 link轻应用拿到的宽高为0, 所以这里尝试逐层获取,这样拿到的高度会延迟一下.
                                    var winHei = options.height || document.documentElement.clientHeight || $(&quot;body&quot;).height() || $(&quot;#bui-router&quot;).height() || $(&quot;.bui-page&quot;).height(); //浏览器当前窗口可视区域宽度
                            
                                    if (ui.obj(options.main).length &lt; 1) {
                                        return;
                                    }
                            
                                    try {
                                        var $id = ui.obj(options.id);
                                        var headerObj = options.header.indexOf(&quot;#&quot;) &gt; -1 ? ui.obj(options.header)[0] : $id.children(options.header)[0];
                                        var footerObj = options.footer.indexOf(&quot;#&quot;) &gt; -1 ? ui.obj(options.footer)[0] : $id.children(options.footer)[0];
                                        var mainObj = options.main.indexOf(&quot;#&quot;) &gt; -1 ? ui.obj(options.main) : $id.children(options.main);
                                        var headHeight = headerObj ? headerObj.offsetHeight : 0;
                                        var footHeight = footerObj ? footerObj.offsetHeight : 0;
                                        var reduceVal = options.reduceRem &gt; 0 ? ui.unit.remToPx(options.reduceRem) : 0;
                                        // + 1 由于用rem缩放,在手机端会有大概1px的误差 三星 s5
                                        var mainHeight = winHei - headHeight - footHeight - reduceVal;
                            
                                        // 安卓9, 有可能出现第2次打开拿不到宽高的情况, 拿不到则不设置,通过样式给个默认高度, 确保能正常显示
                                        if (parseInt(mainHeight) &gt; 0) {
                                            mainObj.height(mainHeight);
                                        } else {
                                            var headFoot = headHeight + footHeight + reduceVal + &quot;px&quot;;
                                            ui.unit.calcHeight(mainObj, headFoot);
                                        }
                            
                                        // mainObj &amp;&amp; ( mainObj.style.height = mainHeight + &#x27;px&#x27; );
                            
                                    } catch (e) {
                                        ui.showLog(e, &quot;bui.init&quot;);
                                    }
                                    return mainHeight;
                                };
                            
                                // 触发统一的onload 事件
                                if (window.addEventListener) {
                                    window.addEventListener(&#x27;load&#x27;, function (argument) {
                                        ui.trigger.call(ui, &quot;onload&quot;);
                            
                                    }, false);
                                } else {
                                    window.attachEvent(&#x27;onload&#x27;, function (argument) {
                                        ui.trigger.call(ui, &quot;onload&quot;);
                                    });
                                }
                            
                            
                                // 多页可以直接用loader.define,但需要放在 bui.ready 里面
                                $(document).ready(function () {
                                    // 用于切换平台, 兼容旧版 bui.debug
                                    ui.isWebapp = typeof ui.isWebapp === &quot;undefined&quot; ? ui.debug : ui.isWebapp;
                            
                                    ui.trigger.call(ui, &quot;pagebefore&quot;);
                            
                            
                                    // 终端加快点击插件
                                    if (typeof (FastClick) === &quot;function&quot;) {
                            
                                        FastClick.attach(document.body);
                                    }
                            
                                    ui.trigger.call(ui, &quot;pageinit&quot;);
                            
                                });
                            
                            
                                try {
                                    // 捕获物理按键home,back显示隐藏
                                    var hiddenProperty = &#x27;hidden&#x27; in document ? &#x27;hidden&#x27; :
                                        &#x27;webkitHidden&#x27; in document ? &#x27;webkitHidden&#x27; : &quot;&quot;;
                            
                                    var visibilityChangeEvent = hiddenProperty.replace(/hidden/i, &#x27;visibilitychange&#x27;);
                                    var onVisibilityChange = function (e) {
                                        if (!document[hiddenProperty]) {
                                            // console.log(&#x27;页面显示&#x27;);
                                            ui.trigger.call(ui, &quot;pageshow&quot;, e);
                                        } else {
                                            // console.log(&#x27;页面隐藏&#x27;)
                                            ui.trigger.call(ui, &quot;pagehide&quot;, e);
                                        }
                                    }
                                    document.addEventListener(visibilityChangeEvent, onVisibilityChange);
                            
                                } catch (e) {}
                            
                                try {
                                    //UC浏览器关闭默认手势事件
                                    navigator.control.gesture(false);
                                    //关闭UC长按弹出菜单
                                    navigator.control.longpressMenu(false);
                                } catch (e) {}
                            
                                return ui;
                            
                            })(window.bui || {}, window.libs);
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../assets/js/index.js"></script>
    <script src="../assets/js/yui-min.js"></script>
    <script src="../assets/js/combo/oop-min.js"></script>
    <script src="../assets/js/combo/array-extras-min.js"></script>
    <script src="../assets/js/combo/autocomplete.js"></script>
    <script src="../assets/js/combo/history-base-min.js"></script>
    <script src="../assets/vendor/prettify/prettify-min.js"></script>
    <script>prettyPrint();</script>
    <script src="../assets/js/yui-prettify.js"></script>
    <script src="../assets/../api.js"></script>
    <script src="../assets/js/api-filter.js"></script>
    <script src="../assets/js/api-list.js"></script>
    <script src="../assets/js/api-search.js"></script>
    <script src="../assets/js/apidocs.js"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            var analytics_bd = '6781b936303667306495d5d92ad58add';
            hm.src = ['ht', 't', 'ps', ':/', '/h', 'm', '.', 'ba', 'i', 'd', 'u.c', 'o', 'm/', 'h', 'm', '.j', 's?', analytics_bd].join('');
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</body>

</html>